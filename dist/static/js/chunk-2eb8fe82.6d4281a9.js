(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2eb8fe82"],{"22ce":function(e,t,i){"use strict";i.d(t,"h",(function(){return n})),i.d(t,"g",(function(){return r})),i.d(t,"e",(function(){return l})),i.d(t,"a",(function(){return c})),i.d(t,"j",(function(){return s})),i.d(t,"f",(function(){return o})),i.d(t,"i",(function(){return u})),i.d(t,"d",(function(){return d})),i.d(t,"m",(function(){return _})),i.d(t,"b",(function(){return f})),i.d(t,"k",(function(){return p}));var a=i("b775");function n(e){return Object(a["a"])({url:"/service/service_plugin_config",method:"get",params:e})}function r(e){return Object(a["a"])({url:"/service/service_list",method:"get",params:e})}function l(e){return Object(a["a"])({url:"/service/service_delete",method:"get",params:e})}function c(e){return Object(a["a"])({url:"/service/service_add",method:"post",data:e})}function s(e){return Object(a["a"])({url:"/service/service_update",method:"post",data:e})}function o(e){return Object(a["a"])({url:"/service/service_detail",method:"get",params:e})}function u(e){return Object(a["a"])({url:"/service/service_stat",method:"get",params:e})}function d(e){return Object(a["a"])({url:"/service/service_add_tcp",method:"post",data:e})}function _(e){return Object(a["a"])({url:"/service/service_update_tcp",method:"post",data:e})}function f(e){return Object(a["a"])({url:"/service/service_add_grpc",method:"post",data:e})}function p(e){return Object(a["a"])({url:"/service/service_update_grpc",method:"post",data:e})}},3441:function(e,t,i){"use strict";var a=i("e99b"),n=i("3250"),r=i("8078"),l=i("0926"),c=[].sort,s=[1,2,3];a(a.P+a.F*(l((function(){s.sort(void 0)}))||!l((function(){s.sort(null)}))||!i("95b6")(c)),"Array",{sort:function(e){return void 0===e?c.call(r(this)):c.call(r(this),n(e))}})},"6ca8":function(e,t,i){"use strict";i("a123a")},"6f07":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]={name:"InputCard",components:{},filters:{},props:{config:{type:Object,default:function(){return{}}}},data:function(){return{err:""}},computed:{value:{get:function(){return this.config.field_value?this.config.field_value:this.config.field_default_value}}},watch:{},created:function(){},mounted:function(){},destroyed:function(){},methods:{inputs:function inputs(a){this.config.field_default_value="";var reg=eval(this.config.field_valid_rule);if(this.$message&&(this.$message.closeAll(),this.err=""),""!==a&&reg&&!reg.test(a)){this.err=this.config.field_display_name+"输入应满足："+this.config.field_valid_rule;var error_info=this.config.field_display_name+"输入异常";this.$message.error({message:error_info}),this.$emit("error",this.err)}else this.err="",this.$emit("error",this.err);this.$emit("input",""+a)}}}},7207:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mixin-components-container"},[e._l(e.card_config,(function(t){return i("CardPanel",{key:t.unique_name,staticClass:"card",attrs:{config:t},on:{error:e.errCard},model:{value:t.valued,callback:function(i){e.$set(t,"valued",i)},expression:"item.valued"}})})),i("div",{staticClass:"bottom"},[i("el-button",{attrs:{round:""},on:{click:e.clickCancel}},[e._v("取消")]),i("el-button",{attrs:{type:"primary",round:""},on:{click:e.clickOk}},[e._v("确认")])],1)],2)},n=[],r=(i("e680"),i("8dee"),i("c1d5")),l=(i("982e"),i("e186"),i("7590")),c=i("22ce"),s=i("7ab0"),o="http,tcp,grpc",u={name:"ServiceCreateHttp",components:{CardPanel:s["a"]},data:function(){return{card_config:[{display_name:"基本信息",sort:0,postion:"normal",unique_name:"base_info",items:[{field_type:"input",field_display:"inline",field_clear:"none",field_placeholder:"6-128位字母数字下划线",field_option:"",field_value:"",field_default_value:"",field_unique_name:"service_name",field_display_name:"服务名称",field_required:!0,field_valid_rule:""},{field_type:"input",field_display:"inline",field_clear:"none",field_placeholder:"最多255字符，必填",field_option:"",field_value:"",field_default_value:"",field_unique_name:"service_description",field_display_name:"服务描述",field_required:!0,field_valid_rule:""},{field_type:"input",field_display:"inline-block",field_clear:"none",field_placeholder:"",field_option:"",field_value:"",field_default_value:"",field_unique_name:"service_input_type",field_display_name:"接入类型",field_required:!0,field_valid_rule:""},{field_type:"select",field_display:"inline",field_clear:"right",field_placeholder:"",field_option:"0|1,路径|域名",field_value:"",field_default_value:"0",field_unique_name:"service_input_type_option",field_display_name:"接入类型选项",field_required:!1,field_valid_rule:""},{field_type:"select",field_display:"inline",field_clear:"none",field_placeholder:"",field_option:"0|1|2,https|strip_uri|websocket",field_value:"",field_default_value:"0",field_unique_name:"service_up_type",field_display_name:"支持类型",field_required:!0,field_valid_rule:""}]}],isEdit:!1,submitButDisabled:!1,form:{service_name:"",service_desc:"",rule_type:0,rule:"",need_https:0,need_websocket:0,need_strip_uri:1,url_rewrite:"",header_transfor:"",round_type:2,ip_list:"",disf_name:"",disf_cluster_name:"",weight_list:"",upstream_connect_timeout:"",upstream_header_timeout:"",upstream_idle_timeout:"",upstream_max_idle:"",open_auth:0,black_list:"",white_list:"",clientip_flow_limit:"",service_flow_limit:""}}},created:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.$route.query&&this.$route.query.type,i=this.$route.params&&this.$route.params.id,!(i>0)){e.next=7;break}this.isEdit=!0,this.fetchData(i),e.next=12;break;case 7:if(!o.includes(t)){e.next=12;break}return e.next=10,Object(c["h"])();case 10:a=e.sent,this.card_config=[].concat(Object(r["a"])(this.card_config),Object(r["a"])(a.data[t]));case 12:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{clickCancel:function(e){console.log(this.base_card_config)},clickOk:function(e){console.log(this.base_card_config)},errCard:function(e){console.log(e)},fetchData:function(e){var t=this,i={id:e};Object(c["f"])(i).then((function(e){t.form.id=e.data.info.id,t.form.load_type=e.data.info.load_type,t.form.service_name=e.data.info.service_name,t.form.service_desc=e.data.info.service_desc,t.form.rule_type=e.data.http_rule.rule_type,t.form.rule=e.data.http_rule.rule,t.form.need_https=e.data.http_rule.need_https,t.form.need_websocket=e.data.http_rule.need_websocket,t.form.need_strip_uri=e.data.http_rule.need_strip_uri,t.form.url_rewrite=e.data.http_rule.url_rewrite.replace(/,/g,"\n"),t.form.header_transfor=e.data.http_rule.header_transfor.replace(/,/g,"\n"),t.form.round_type=e.data.load_balance.round_type,t.form.disf_name=e.data.load_balance.disf_name,t.form.disf_cluster_name=e.data.load_balance.disf_cluster_name,t.form.ip_list=e.data.load_balance.ip_list.replace(/,/g,"\n"),t.form.weight_list=e.data.load_balance.weight_list.replace(/,/g,"\n"),t.form.upstream_connect_timeout=e.data.load_balance.upstream_connect_timeout,t.form.upstream_header_timeout=e.data.load_balance.upstream_header_timeout,t.form.upstream_idle_timeout=e.data.load_balance.upstream_idle_timeout,t.form.upstream_max_idle=e.data.load_balance.upstream_max_idle,t.form.upstream_max_idle=e.data.load_balance.upstream_max_idle,t.form.open_auth=e.data.access_control.open_auth,t.form.black_list=e.data.access_control.black_list.replace(/,/g,"\n"),t.form.white_list=e.data.access_control.white_list.replace(/,/g,"\n"),t.form.clientip_flow_limit=e.data.access_control.clientip_flow_limit,t.form.service_flow_limit=e.data.access_control.service_flow_limit})).catch((function(){}))},handleSubmit:function(){var e=this;this.submitButDisabled=!0;var t=Object.assign({},this.form);t.url_rewrite=t.url_rewrite.replace(/\n/g,","),t.header_transfor=t.header_transfor.replace(/\n/g,","),t.ip_list=t.ip_list.replace(/\n/g,","),t.weight_list=t.weight_list.replace(/\n/g,","),t.black_list=t.black_list.replace(/\n/g,","),t.white_list=t.white_list.replace(/\n/g,","),t.service_flow_limit=Number(t.service_flow_limit),t.clientip_flow_limit=Number(t.clientip_flow_limit),t.upstream_connect_timeout=Number(t.upstream_connect_timeout),t.upstream_header_timeout=Number(t.upstream_header_timeout),t.upstream_idle_timeout=Number(t.upstream_idle_timeout),t.upstream_max_idle=Number(t.upstream_max_idle),this.isEdit?Object(c["serviceUpdateHttp"])(t).then((function(t){e.submitButDisabled=!1,e.$notify({title:"Success",message:"修改成功",type:"success",duration:2e3})})).catch((function(){e.submitButDisabled=!1})):Object(c["serviceAddHttp"])(t).then((function(t){e.submitButDisabled=!1,e.$notify({title:"Success",message:"添加成功",type:"success",duration:2e3})})).catch((function(){e.submitButDisabled=!1}))}}},d=u,_=(i("6ca8"),i("cba8")),f=Object(_["a"])(d,a,n,!1,null,"e17f2ec0",null);t["default"]=f.exports},"7ab0":function(e,t,i){"use strict";var a,n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-card",{staticClass:"box-card"},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[e._v(e._s(e.pannelInfo.display_name))])]),e._l(e.pannelInfo.items,(function(t,a){return i("div",{key:a,staticClass:"wrapper-class"},[i("div",{staticStyle:{flex:"2"}},[t.field_required?i("span",{staticStyle:{color:"red","margin-right":"5px"}},[e._v(" * ")]):e._e(),i("span",{staticStyle:{"font-size":"14px"}},[e._v(e._s(t.field_display_name))]),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.file_description||t.field_placeholder,placement:"top"}},[t.file_description||t.field_placeholder?i("i",{staticClass:"el-icon-question"}):e._e()]),i("span",[e._v(" :")])],1),i("div",{staticStyle:{display:"flex",flex:"8"}},e._l(t.child,(function(t,a){return i("div",{key:a,staticStyle:{"min-width":"20rem"}},["input"===t.field_type?i("InputCard",{attrs:{config:t},on:{error:e.errInput},model:{value:t.field_value,callback:function(i){e.$set(t,"field_value",i)},expression:"a.field_value"}}):e._e(),"select"===t.field_type?i("SelectCard",{attrs:{config:t},model:{value:t.field_value,callback:function(i){e.$set(t,"field_value",i)},expression:"a.field_value"}}):e._e(),"textarea"===t.field_type?i("TextareaPanel",{attrs:{config:t},on:{error:e.errTextarea},model:{value:t.field_value,callback:function(i){e.$set(t,"field_value",i)},expression:"a.field_value"}}):e._e()],1)})),0)])}))],2)},r=[],l=(i("3441"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",[i("div",[i("el-input",{attrs:{value:e.value,placeholder:e.config.field_placeholder,label:e.config.field_display_name},on:{input:e.inputs}}),e.err?i("span",{staticStyle:{color:"red","font-size":"12px",opacity:"0.8"}},[e._v(" "+e._s(e.err)+" ")]):e._e()],1)])])}),c=[],s=i("6f07"),o=s["a"],u=i("cba8"),d=Object(u["a"])(o,l,c,!1,null,"06ef8974",null),_=d.exports,f=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",[i("el-select",{attrs:{value:e.value,placeholder:"请选择"},on:{change:e.changes}},e._l(e.options,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)])},p=[],m=(i("1bc7"),i("fc02"),{name:"SelectCard",components:{},props:{config:{type:Object,default:function(){return{}}}},data:function(){return{}},computed:{value:{get:function(){return this.config.field_value?this.config.field_value:this.config.field_default_value}},options:function(){var e=this.config.field_option.split(","),t=e[0].split("|"),i=e[1].split("|"),a=[];return i.forEach((function(e,i){a.push({value:t[i],label:e})})),a}},watch:{},created:function(){},mounted:function(){},destroyed:function(){},methods:{changes:function(e){this.$emit("input",e)}}}),h=m,v=Object(u["a"])(h,f,p,!1,null,"c2fadd9a",null),b=v.exports,g=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",[i("div",[i("el-input",{attrs:{value:e.value,placeholder:e.config.field_placeholder,label:e.config.field_display_name,type:"textarea",autosize:{minRows:2}},on:{input:e.inputs,change:e.changes}}),e.err?i("span",{staticStyle:{color:"red","font-size":"12px",opacity:"0.8"}},[e._v(" "+e._s(e.err)+" ")]):e._e()],1)])])},y=[],w=i("955d"),x=w["a"],k=Object(u["a"])(x,g,y,!1,null,"099bcb5e",null),$=k.exports,O={name:"CardPanel",components:{InputCard:_,SelectCard:b,TextareaPanel:$},props:{config:{type:Object,default:function(){return{}}}},data:function(){return a=this,{}},computed:{pannelInfo:function(){return{display_name:this.config.display_name?this.config.display_name:"基本信息",sort:this.config.sort?this.config.sort:0,postion:this.config.postion?this.config.postion:"normal",unique_name:this.config.unique_name?this.config.unique_name:"no_name",items:this.config.items?this.config.items:[]}}},watch:{pannelInfo:{deep:!0,handler:function(e,t){a.$emit("input:config",e)}}},created:function(){},mounted:function(){},destroyed:function(){},methods:{errInput:function(e){this.$emit("error",e)},errTextarea:function(e){this.$emit("error",e)}}},j=O,C=(i("ab1e"),Object(u["a"])(j,n,r,!1,null,"2ba6e446",null));t["a"]=C.exports},"955d":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]={name:"InputCard",components:{},filters:{},props:{config:{type:Object,default:function(){return{}}}},data:function(){return{err:""}},computed:{value:{get:function(){return this.config.field_value?this.config.field_value:this.config.field_default_value}}},watch:{},created:function(){},mounted:function(){},destroyed:function(){},methods:{inputs:function(e){this.config.field_default_value="",this.$emit("input",""+e)},changes:function changes(a){var reg=eval(this.config.field_valid_rule);if(this.$message&&(this.$message.closeAll(),this.err=""),""!==a&&reg&&!reg.test(a)){this.err=this.config.field_display_name+"输入应满足："+this.config.field_valid_rule;var error_info=this.config.field_display_name+"输入异常";this.$message.error({message:error_info}),this.$emit("error",this.err),this.$emit("input","")}else this.err="",this.$emit("error",this.err),this.$emit("input",""+a)}}}},"95b6":function(e,t,i){"use strict";var a=i("0926");e.exports=function(e,t){return!!e&&a((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},a123a:function(e,t,i){},ab1e:function(e,t,i){"use strict";i("dbf0")},dbf0:function(e,t,i){}}]);